/*! clickstreamr 05-09-2018 */
window.Clickstreamr=function(a,b){this.debug=b.debug,this.debug&&window.console&&"function"==typeof window.console.log&&(console.log("on tracker: "+a.get("name")),console.log(b.server));var c=window[window.GoogleAnalyticsObject||"ga"];"function"==typeof c&&c(function(b){var c=a.get("sendHitTask");a.set("sendHitTask",function(a){c(a),d.setProtocol(window.location.protocol).setPayload(a.get("hitPayload")).crossDomainResponder().checkForNewSession().sendPixel(),d.crossDomainListener(),_clickstreamr.loadOnce=!0})});var d={_pixelServer:b.server,_pixelProtocol:b.protocol||window.location.protocol,_session_id_cookie_name:b.sessionIDCookieName||"_csSessionID",_traffic_cookie_name:b.trafficCookieName||"_csTraffic",_referrer_exclude:b.referrerExcludeArray||[],_cross_domain_link:b.crossDomainLink||[],_force_https:b.forceHttps||!1,_payload:"",_utc_offset:b.utcOffset||-8,_additionalParametersObject:b.additionalParametersObject||[],trafficAttribution:{adID:"",source:"",campaign:"",medium:"",term:"",content:""},setProtocol:function(a){return"http:"!=a&&"https:"!=a||(this._pixelProtocol=a),this._force_https&&(this._pixelProtocol="https:"),this},setPayload:function(a){return this._payload=a,this},setSessionCookieID:function(a,b){var c=Math.round((new Date).getTime()/1e3),d=Math.round(2147483647*Math.random())+"."+c;return b?this._setCookie(this._session_id_cookie_name,d,a,this._utc_offset,!0):""!=_clickstreamr.getCookie(this._session_id_cookie_name)?this._setCookie(this._session_id_cookie_name,_clickstreamr.getCookie(this._session_id_cookie_name),a,this._utc_offset,!0):this._setCookie(this._session_id_cookie_name,d,a,this._utc_offset,!0),this},buildGUID:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return this.guid=a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a(),this},getDataLayer:function(){const a=function(a,b){if(!a.startsWith("gtm.element"))return b};var b=window.dataLayer;if(b&&b.length>0)try{b=JSON.stringify(b,a),b=encodeURIComponent(b)}catch(a){b=""}else b="";return b},sendPixel:function(){var a=_clickstreamr.getCookie(this._traffic_cookie_name,!0),b=_clickstreamr.getCookie(this._session_id_cookie_name);this.buildGUID();var c=this.getDataLayer(),d=this._payload+"&cssid="+b+"&css="+encodeURIComponent(a.source)+"&csm="+encodeURIComponent(a.medium)+"&csc="+encodeURIComponent(a.campaign)+"&cst="+encodeURIComponent(a.term)+"&csa="+encodeURIComponent(a.content)+"&csg="+encodeURIComponent(a.adID)+"&guid="+encodeURIComponent(this.guid)+"&dlart="+c;if(Object&&Object.keys&&Object.values&&Object.keys(this._additionalParametersObject)&&Object.keys(this._additionalParametersObject).length)for(var e=0;e<Object.keys(this._additionalParametersObject).length;e++)Object.keys(this._additionalParametersObject)[e]&&Object.values(this._additionalParametersObject)[e]&&(d+="&"+encodeURIComponent(Object.keys(this._additionalParametersObject)[e].toString())+"="+encodeURIComponent(Object.values(this._additionalParametersObject)[e].toString()));var f=new XMLHttpRequest;f.open("POST",this._pixelProtocol+"//"+this._pixelServer+"/collect",!0),f.withCredentials=!0,f.send(d)},_setCookie:function(a,b,c,d,e){var f=new Date;f.setTime(f.getTime()+6e4*f.getTimezoneOffset()),f.setTime(f.getTime()+36e5*d);var g=new Date;return g.setTime(f.getTime()+6e4*parseInt(c)),1==e&&f.toLocaleDateString()!=g.toLocaleDateString()&&(f.setHours(24,0,0,0),g=f),g.setTime(g.getTime()-6e4*g.getTimezoneOffset()),g.setTime(g.getTime()-36e5*d),"object"==typeof b&&(b=JSON.stringify(b)),document.cookie=a+"="+escape(b)+"; expires="+g.toUTCString()+"; path=/",this},checkForNewSession:function(){var a=document.location.host,b=document.location.search,c=document.referrer;this._getQueryParameter(b,"utm_referrer")?c=this._getQueryParameter(b,"utm_referrer"):this._getQueryParameter(b,"utm_expid")&&(c=""),this.parseDirect(a,b,c).parseReferral(a,b,c).parseOrganicSearch(a,b,c).parseUTMparameters(a,b,c).parseAdWords(a,b,c).parseDoubleClick(a,b,c);var d=_clickstreamr.getCookie(this._traffic_cookie_name,!0);return"object"==typeof d&&null!=d?"(direct)"!=this.trafficAttribution.source&&""!=this.trafficAttribution.source?this.trafficAttribution.source!=d.source||this.trafficAttribution.medium!=d.medium||this.trafficAttribution.campaign!=d.campaign||this.trafficAttribution.term!=d.term||this.trafficAttribution.content!=d.content||this.trafficAttribution.adID!=d.adID?(this.setSessionCookieID(30,!0),this._setCookie(this._traffic_cookie_name,this.trafficAttribution,259200,1,!1)):(this._setCookie(this._traffic_cookie_name,d,259200,1,!1),this.setSessionCookieID(30)):this.setSessionCookieID(30):(this.setSessionCookieID(30,!0),this._setCookie(this._traffic_cookie_name,this.trafficAttribution,259200,1,!1)),this},_getQueryString:function(a){if("string"==typeof a&&a.length>0){var b=document.createElement("a");return b.href=a,""!==b.search?b.search:"?"}return"?"},parseAdWords:function(a,b,c){return""===this._getQueryParameter(b,"gclid")&&""===this._getQueryParameter(b,"gclsrc")||(this.trafficAttribution.adID=""+this._getQueryParameter(b,"gclid")+this._getQueryParameter(b,"gclsrc"),""!==this._getQueryParameter(b,"utm_source")?this.trafficAttribution.source=this._getQueryParameter(b,"utm_source"):this.trafficAttribution.source="google",""!==this._getQueryParameter(b,"utm_medium")?this.trafficAttribution.medium=this._getQueryParameter(b,"utm_medium"):this.trafficAttribution.medium="cpc",""!==this._getQueryParameter(b,"utm_campaign")?this.trafficAttribution.campaign=this._getQueryParameter(b,"utm_campaign"):this.trafficAttribution.campaign="(not set)",""!==this._getQueryParameter(b,"utm_content")?this.trafficAttribution.content=this._getQueryParameter(b,"utm_content"):this.trafficAttribution.content="",""!==this._getQueryParameter(b,"utm_term")?this.trafficAttribution.term=this._getQueryParameter(b,"utm_term"):this.trafficAttribution.term="(not provided)"),this},parseDoubleClick:function(a,b,c){return""!==this._getQueryParameter(b,"dclid")&&(this.trafficAttribution.adID=""+this._getQueryParameter(b,"dclid"),""!==this._getQueryParameter(b,"utm_source")?this.trafficAttribution.source=this._getQueryParameter(b,"utm_source"):this.trafficAttribution.source="google",""!==this._getQueryParameter(b,"utm_medium")?this.trafficAttribution.medium=this._getQueryParameter(b,"utm_medium"):this.trafficAttribution.medium="display",""!==this._getQueryParameter(b,"utm_campaign")?this.trafficAttribution.campaign=this._getQueryParameter(b,"utm_campaign"):this.trafficAttribution.campaign="(not set)",""!==this._getQueryParameter(b,"utm_content")?this.trafficAttribution.content=this._getQueryParameter(b,"utm_content"):this.trafficAttribution.content="",""!==this._getQueryParameter(b,"utm_term")?this.trafficAttribution.term=this._getQueryParameter(b,"utm_term"):this.trafficAttribution.term="(not provided)"),this},parseUTMparameters:function(a,b,c){return""!=this._getQueryParameter(b,"utm_source")&&(this.trafficAttribution.source=this._getQueryParameter(b,"utm_source"),this.trafficAttribution.medium=this._getQueryParameter(b,"utm_medium"),this.trafficAttribution.campaign=this._getQueryParameter(b,"utm_campaign"),this.trafficAttribution.content=this._getQueryParameter(b,"utm_content"),this.trafficAttribution.term=this._getQueryParameter(b,"utm_term"),this.trafficAttribution.adID=""),this},parseOrganicSearch:function(a,b,c){if(!1===this._hostsAreEqual("http://"+a,c)||this._getQueryParameter(b,"utm_referrer")){var d=c.match(/^https?:\/\/(.*\.search\.|www\.)?(google|bing|aol|yahoo|ask|comcast).([a-z]+)([\.a-z]{3,5})?/);if(null!==d){var e=this._getQueryString(c),f=this._getQueryParameter(e,"q");this.trafficAttribution.source=d[2],this.trafficAttribution.medium="organic",this.trafficAttribution.campaign="(organic)",this.trafficAttribution.content="",this.trafficAttribution.term=""===f?"(not provided)":f,this.trafficAttribution.adID=""}}return this},parseReferral:function(a,b,c){if("string"==typeof c&&c.length>0&&!1===this._hostsAreEqual("http://"+a,c)){if(this._referrer_exclude.length>0)for(var d=0;d<this._referrer_exclude.length;d++){var e=new RegExp(this._referrer_exclude[d]);if(1==e.test(c))return this}var f=c.match(/^https?:\/\/([^\/]+)\/?(.*)$/);null!==f&&(this.trafficAttribution.source=f[1],this.trafficAttribution.medium="referral",this.trafficAttribution.campaign="(referral)",this.trafficAttribution.content="/"+f[2],this.trafficAttribution.term="",this.trafficAttribution.adID="")}return this},parseDirect:function(a,b,c){var d=!1;if(c.length&&this._referrer_exclude.length>0)for(var e=0;e<this._referrer_exclude.length;e++){var f=new RegExp(this._referrer_exclude[e]);1==f.test(c)&&(d=!0)}return("string"==typeof c&&0===c.length||d)&&(this.trafficAttribution.source="(direct)",this.trafficAttribution.medium="(none)",this.trafficAttribution.campaign="(direct)",this.trafficAttribution.content="",this.trafficAttribution.term="",this.trafficAttribution.adID=""),this},_getQueryParameter:function(a,b){if(a){for(var c=a.substring(1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(decodeURIComponent(f[0])==b)return decodeURIComponent(f[1])}return""}return""},_hostsAreEqual:function(a,b){var c=document.createElement("a");c.href=a;var d=document.createElement("a");return d.href=b,c=c.host,"www."==c.substring(0,4)&&(c=c.substring(4)),d=d.host,"www."==d.substring(0,4)&&(d=d.substring(4)),c==d},_getHostname:function(a){var b=document.createElement("a");return b.href=a,b.hostname},_addListener:function(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent&&a.attachEvent("on"+b,c)},crossDomainListener:function(){if(this._cross_domain_link.length>0&&!_clickstreamr.loadOnce){_clickstreamr._session_id_cookie_name=this._session_id_cookie_name,_clickstreamr._traffic_cookie_name=this._traffic_cookie_name;var a=this._getHostname,b=this._hostsAreEqual,c=this._cross_domain_link;this._addListener(document.body,"mousedown",function(d){d=d||window.event;var e=d.target||d.srcElement,f=a(e.href);if("A"==e.tagName&&e.href&&!b("http://"+f,"http://"+document.location.hostname))for(i=0;i<c.length;i++){var g=new RegExp(c[i]);if(g.test(f)){e.href=_clickstreamr.updateQueryStringParameter(e.href,"_csSessionID",encodeURIComponent(_clickstreamr.getCookie(_clickstreamr._session_id_cookie_name))),e.href=_clickstreamr.updateQueryStringParameter(e.href,"_csTraffic",encodeURIComponent(_clickstreamr.getCookie(_clickstreamr._traffic_cookie_name)));break}}})}},crossDomainResponder:function(){if(this._cross_domain_link.length>0){var a=window.location.search;if(a.length>0&&this._getQueryParameter(a,"_csSessionID").length>0&&this._getQueryParameter(a,"_csTraffic").length>0){this._setCookie(this._session_id_cookie_name,this._getQueryParameter(a,"_csSessionID"),30,this._utc_offset,!0);var b={};try{b=window.jQuery?jQuery.parseJSON(decodeURIComponent(this._getQueryParameter(a,"_csTraffic"))):JSON.parse(decodeURIComponent(this._getQueryParameter(a,"_csTraffic")))}catch(a){}this._setCookie(this._traffic_cookie_name,b,259200,1,!1)}}return this},_payload_value:function(a){for(var b=this._payload.split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(decodeURIComponent(d[0])==a)return decodeURIComponent(d[1])}return""}}},window._clickstreamr=window._clickstreamr||{},_clickstreamr.loadOnce=!1,_clickstreamr.version="1.1.2",_clickstreamr.updateQueryStringParameter=function(a,b,c){var d=a.indexOf("#"),e=-1===d?"":a.substr(d);a=-1===d?a:a.substr(0,d);var f=new RegExp("([?&])"+b+"=.*?(&|$)","i"),g=-1!==a.indexOf("?")?"&":"?";return(a=a.match(f)?a.replace(f,"$1"+b+"="+c+"$2"):a+g+b+"="+c)+e},_clickstreamr.getCookie=function(a,b){var c=(document.cookie.match("(^|; )"+a+"=([^;]*)")||0)[2];if(void 0===c&&(c=""),b)try{return window.jQuery?jQuery.parseJSON(decodeURIComponent(c)):JSON.parse(decodeURIComponent(c))}catch(a){}return decodeURIComponent(c)},window.ga=window[window.GoogleAnalyticsObject||"ga"],"function"==typeof ga&&ga("provide","clickstreamr",Clickstreamr);