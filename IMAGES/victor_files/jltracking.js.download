!function(){function t(t){this.access_token=t.cid,this.user_id=void 0!==t.user_id&&null!=t.user_id&&""!==t.user_id&&t.user_id.indexOf("/")<0?t.user_id:"undefined",this.feed_id=void 0===t.feed_id||""==t.feed_id?"any_feed":t.feed_id,this.div=t.div,this.lang=t.lang,this.clicked="function"==typeof t.clicked?t.clicked:function(t){},this.purchased="function"==typeof t.purchased?t.purchased:function(t){},this.logToConsoleCookieName="Tracker_log_to_console",this.logToConsole=o._isConsoleCookieExists(this.logToConsoleCookieName),this.setCookies=void 0!==t.setCookies&&null!=t.setCookies&&t.setCookies,this.autoPageView=void 0!==t.autoPageView&&"boolean"==typeof t.autoPageView&&t.autoPageView,this.log("Tracking initialized with parameters\n\t - access token:"+this.access_token+"\n\t - user id     :"+this.user_id+"\n\t - feed id     :"+this.feed_id+"\n\t - div         :"+this.div+"\n\t - lang        :"+this.lang),this.autoPageView&&this.page_view()}JL={tracking:function(o){JL.tracker=new t(o)}},t.prototype.track=function(t){var o=t.event;this.log(o+" action initiated"),this.log(t);var e="search"==o?this.convertTextData:this.convertDealData;this.performAction(e,o,t)},t.prototype.view=function(t){this.log("Click action initiated"),this.performAction(this.convertDealData,this.a_click,t)},t.prototype.click=function(t){this.log("Click action initiated"),this.performAction(this.convertDealData,this.a_click,t)},t.prototype.purchase=function(t){this.log("Purchase action initiated"),this.performAction(this.convertDealData,this.a_purchase,t)},t.prototype.addToCart=function(t){this.log("AddToCart action initiated"),this.performAction(this.convertDealData,this.a_add_to_cart,t)},t.prototype.removeFromCart=function(t){this.log("RemoveFromCart action initiated"),this.performAction(this.convertDealData,this.a_remove_from_cart,t)},t.prototype.addToWishList=function(t){this.log("AddToWishList action initiated"),this.performAction(this.convertDealData,this.a_add_to_wishlist,t)},t.prototype.removeFromWishList=function(t){this.log("RemoveFromWishList action initiated"),this.performAction(this.convertDealData,this.a_remove_from_wishlist,t)},t.prototype.addToFavorites=function(t){this.log("AddToFavorites action initiated"),this.performAction(this.convertDealData,this.a_add_to_favorites,t)},t.prototype.removeFromFavorites=function(t){this.log("RemoveFromFavorites action initiated"),this.performAction(this.convertDealData,this.a_remove_from_favorites,t)},t.prototype.browse_promo=function(t){this.log("BrowsePromo action initiated"),this.performAction(this.convertTextData,this.a_browse_promo,t)},t.prototype.browse_catalog=function(t){this.log("BrowseCatalog action initiated"),this.performAction(this.convertTextData,this.a_browse_catalog,t)},t.prototype.browse_section=function(t){this.log("BrowseSection action initiated"),this.performAction(this.convertBrowseSectionData,this.a_browse_section,t)},t.prototype.search=function(t){this.log("Search action initiated"),this.performAction(this.convertTextData,this.a_search,t)},t.prototype.page_view=function(){this.log("Page view action initiated"),this.performAction(this.convertTextData,this.a_page_view,[])},t.prototype.addTraits=function(t){this.log("Add user Trait action initiated");var e=this.api_users_url+"/add_traits"+(void 0!==this.user_id?"?jl_id="+this.user_id:"?jl_id=")+"&access_token="+this.access_token+"&jl_traits="+this.serialize(this.convertTraitData,t);this.log("About to sent JSONP request: "+e),o._jsonp(this,e)},t.prototype.performAction=function(t,e,i){i?i.constructor===Array?this.action(t,e,i):o.isValidValue(i.deal_id)||o.isValidValue(i.text)||o.isValidValue(i.id)||o.isValidValue(i.name)||o.isValidValue(i.item_group_id)?this.action(t,e,[i]):this.log("Action skipped. Provided data object is not Array or does not have 'deal_id' or 'text' property"):this.log("Action skipped. No 'data' provided")},t.prototype.urlQuery=function(){for(var t={},o=window.location.search.substring(1).split("&"),e=0;e<o.length;e++){var i=o[e].split("=");if(void 0===t[i[0]])t[i[0]]=i[1];else if("string"==typeof t[i[0]]){var r=[t[i[0]],i[1]];t[i[0]]=r}else t[i[0]].push(i[1])}return t},t.prototype.action=function(t,e,i){var r=this.urlQuery(),s=this.api_url+"/"+e+"/"+this.user_id,a=("undefined"!=typeof did?s+"/"+did:s)+"?access_token="+this.access_token+"&data="+this.serialize(t,i)+"&feed="+this.feed_id,n=void 0!==this.div&&""!=this.div?a+"&div="+this.div:a,c=void 0!==this.lang&&""!=this.lang?n+"&lang="+this.lang:n,l=r.jl_ctx,h=void 0!==r.jl_labels&&""!=r.jl_labels?c+"&jl_labels="+r.jl_labels:c,d=void 0!==l&&""!=l?h+"&jl_ctx="+l:h,p=(void 0!==this.setCookies&&this.setCookies?d+"&set_cookies="+this.setCookies:d)+"&r_source="+window.location.host+window.location.pathname;this.log("About to sent JSONP request: "+p),o._jsonp(this,p)},t.prototype.convertTraitData=function(t){for(var e,i=[],r=t.constructor===Array?t:new Array(t),s=0;s<r.length;s++)e={},o._traverseObject(r[s],function(t,o){switch(t){case"id":"number"==typeof r[s].id&&(e.id=o);break;case"name":e.name=o;break;case"traits":e.traits=o}}),i.push(e);return i},t.prototype.convertDealData=function(t){for(var e,i=[],r=0;r<t.length;r++)e={},o._traverseObject(t[r],function(o,i){switch(o){case"deal_id":e.pid=i;break;case"count":e.count="number"==typeof t[r].count?i:1;break;default:e[o]=i}}),i.push(e);return i},t.prototype.convertBrowseSectionData=function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i],s=r.name,a=r.refinements,n=[];if(null!=a)for(var c=0;c<a.length;c++){var l={};o._traverseObject(a[c],function(t,o){l[t]=o}),n.push(l)}e.push({name:s,refinements:n})}return e},t.prototype.convertTextData=function(t){return t},t.prototype.serialize=function(t,o){var e=JSON.stringify(t(o));return this.log("Data object converted to string: "+e),encodeURIComponent(e)},t.prototype.enableLog=function(){this.logToConsole=!0,this.log("Stored enable log to console 'marker' cookie. Will expire in 1800000 milliseconds"),o._setCookie(this.logToConsoleCookieName,(new Date).getTime(),18e5),this.log("JL logging Enabled")},t.prototype.disableLog=function(){this.log("Removed enable log to console 'marker' cookie"),this.logToConsole=!1,this.log("Stored enable log to console 'marker' cookie. Will expire in -1800000 milliseconds"),o._setCookie(this.logToConsoleCookieName,(new Date).getTime(),-18e5),this.log("JL logging Disabled")},t.prototype.log=function(t){this.logToConsole&&window.console&&window.console.log&&console.log(t)};var o={_traverseObject:function(t,o){for(var e in t)t.hasOwnProperty(e)&&o(e,t[e])},_deepCopyObject:function(t){var o={};return this._traverseObject(t,function(t,e){o[t]=e}),o},_objectToQueryString:function(t){var o="";return this._traverseObject(t,function(t,e){var i="object"==typeof e?JSON.stringify(e):e;o+=encodeURIComponent(t)+"="+encodeURIComponent(i)+"&"}),o},_jsonp:function(t,o){var e=document.createElement("script");e.type="text/javascript",e.src=o,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),t.log("SENT JSONP request: "+o)},_getUTCTime:function(){return new Date(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()).getTime()},_getCookie:function(t){for(var o=t+"=",e=document.cookie.split(";"),i=0;i<e.length;i++){for(var r=e[i];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(o))return r.substring(o.length,r.length)}return""},_setCookie:function(t,o,e){var i=new Date;i.setTime(i.getTime()+e);var r="expires="+i.toUTCString();document.cookie=t+"="+o+"; Path=/; "+r},_isConsoleCookieExists:function(t){return""!==o._getCookie(t)},isValidValue:function(t){return void 0!==t&&null!=t&&""!==t}};t.prototype.a_purchase="purch",t.prototype.a_click="click",t.prototype.a_add_to_cart="add_to_cart",t.prototype.a_remove_from_cart="remove_from_cart",t.prototype.a_add_to_wishlist="add_to_wishlist",t.prototype.a_remove_from_wishlist="remove_from_wishlist",t.prototype.a_add_to_favorites="add_to_favorites",t.prototype.a_remove_from_favorites="remove_from_favorites",t.prototype.a_browse_promo="browse_promo",t.prototype.a_browse_catalog="browse_catalog",t.prototype.a_browse_section="browse_section",t.prototype.api_url="https://api.jetlore.com/track",t.prototype.api_users_url="https://api.jetlore.com/users",t.prototype.a_search="search",t.prototype.a_page_view="page_view"}();